{/*
SPDX-FileCopyrightText: 2025 Jack Henry

SPDX-License-Identifier: Apache-2.0
*/}

import { Meta, ArgTypes } from '@storybook/blocks';
import * as stories from './input.stories.js';

<Meta title="Components/Input" of={stories} />

# Input

[Guidelines](https://jackhenry.design/v2/components/input/)

<hr />

The input component offers a single-line text field for collecting user data. The component also serves as a base input that can be extended in order to create specialized input fields. See [Extending jh-input](#extending-jh-input) for details.

## Usage

Import the `<jh-input>` component:

```javascript
import '@jack-henry/jh-elements/components/input/input.js';
```

To use `<jh-input>`:

```html
<jh-input label="Full name" helper-text="Enter as it appears on ID">
  <jh-icon-id-card
    slot="jh-input-right"
    aria-hidden="true"
  ></jh-icon-id-card>
</jh-input>
```

## Dependencies
The input component makes use of both required compositional and suggested content related dependencies.

1. Composition - the following required dependencies are automatically imported:

- `<jh-button>`. [Button component documentation](/docs/components-button--docs).
- `<jh-icon-circle-xmark>`. [Iconography documentation](/docs/iconography-overview--docs).

2. Content -  the following suggested dependencies should be imported when needed: 

- `<jh-icon>`. [Iconography documentation](/docs/iconography-overview--docs).

## Slotting Buttons

When slotting jh-button(s) within the `jh-input-left` or `jh-input-right` slots, consider setting `appearance="tertiary"` and `size="small"` for consistent styles across the input component. 

## Input Mask
Utilize the `input-mask` attribute to assist users in formatting input values. As a user inputs data into the input field, the data will be transformed to the specified format. Input masks consist of the following character types: 

1. Meta characters: These characters restrict the type of keys a user can enter. The design system provides the following meta characters to simplify input masking:
    - `9` : Represents numerical characters. 
    - `a` : Represents alphabetical characters. 
    - `*` : Represents alpha-numerical characters. 

2. Fixed characters: These characters are automatically added to the input field as the user types and are removed when the surrounding characters are deleted. The input-mask manages the addition and removal of these fixed characters. If a user tries to delete a fixed character using 'Backspace', the previous meta character will be deleted. If a user tries to delete a fixed character using 'Delete', the next meta character will be deleted. If a user selects a fixed character to delete it, the fixed character will remain, and the caret will move in the direction of the keypress.

3. Escape Characters: These characters indicate that the following meta character should be treated as a fixed character. An escape character consists of two backslash characters (`\\`). 

For example, `input-mask:'+\\91 99999 99999'` would format the value `1234567890` and return `+91 12345 67890`. 

<img src="/images/input-mask-example.png" alt="Infographic depicting meta, fixed, and escape characters within the input-mask +\\91 99999 99999, explained in the example above." />

Note that input masking does not occur on paste events. This prevents the removal of characters without the user’s knowledge, which could lead to incorrect data being submitted in a form. It is the authors responsibility to validate the input field when needed. 

Additionally, input masking does not enforce a maxlength and characters that surpass the length of the input-mask will not be validated. Authors should set the `maxlength` property as needed and account for any fixed characters when determining the maxlength. 

The `jh-input` event is triggered on input. The event details include both the formatted and unformatted input values, and can be accessed via `e.detail.value` and `e.detail.rawValue`, respectively.

## Character Counter

Set the `show-char-count` attribute to display a character counter. 

The `jh-maxlength` event is triggered when the character count hits the defined `maxlength`. This allows authors to apply the `invalid` property along with the corresponding `error-text` attribute, helping to inform the user that the character limit has been reached.

## Extending jh-input
The `jh-input` component offers a fundamental set of features designed to help developers swiftly create customized inputs. By extending `jh-input` and utilizing the available attributes, methods, slots, and events, developers can easily enhance the input component’s functionality to meet specific needs. See [Extending the Design System](/docs/guides-extending-the-design-system--docs) for additional information.  

## Accessibility

This component satisfies [WCAG 2.2](https://www.w3.org/TR/WCAG22/) AA success criteria.
The following success criteria are of concern:

- [WCAG 1.3.1 Info and Relationships](https://www.w3.org/WAI/WCAG22/Understanding/info-and-relationships.html): Information, structure, and relationships conveyed through presentation can be programmatically determined or are available in text.
- [WCAG 1.3.5 Identify Input Purpose](https://www.w3.org/WAI/WCAG22/Understanding/identify-input-purpose.html): The purpose of each input field collecting information about the user can be programmatically determined when:
  - The input field serves a purpose identified in the [Input Purposes for user interface components](https://www.w3.org/TR/WCAG22/#input-purposes) section; and
  - The content is implemented using technologies with support for identifying the expected meaning for form input data.
- [WCAG 1.4.1 Use of Color](https://www.w3.org/WAI/WCAG22/Understanding/use-of-color.html): Color is not used as the only visual means of conveying information, indicating an action, prompting a response, or distinguishing a visual element.
- [WCAG 1.4.4 Resize Text](https://www.w3.org/WAI/WCAG22/Understanding/resize-text.html): Except for captions and images of text, text can be resized without assistive technology up to 200 percent without loss of content or functionality.
- [WCAG 1.4.11 Non-text Contrast](https://www.w3.org/WAI/WCAG22/Understanding/non-text-contrast.html): The visual presentation of the following have a contrast ratio of at least 3:1 against adjacent color(s):
  - User Interface Components: visual information required to identify user interface components and states, except for inactive components or where the appearance of the component is determined by the user agent and not modified by the author;
  - Graphical Objects: parts of graphics required to understand the content, except when a particular presentation of graphics is essential to the information being conveyed.
- [WCAG 2.1.1 Keyboard](https://www.w3.org/WAI/WCAG22/Understanding/keyboard.html): All functionality of the content is operable through a keyboard interface without requiring specific timings for individual keystrokes, except where the underlying function requires input that depends on the path of the user's movement and not just the endpoints.
- [WCAG 2.4.6 Headings and Labels](https://www.w3.org/WAI/WCAG22/Understanding/headings-and-labels.html): Headings and labels describe topic or purpose.
- [WCAG 2.4.7 Focus Visible](https://www.w3.org/WAI/WCAG22/Understanding/focus-visible.html): Any keyboard operable user interface has a mode of operation where the keyboard focus indicator is visible.
- [WCAG 2.5.8 Target Size (Minimum)](https://www.w3.org/WAI/WCAG22/Understanding/target-size-minimum.html): The size of the target for pointer inputs is at least 24 by 24 CSS pixels, except where:
  - Spacing: Undersized targets (those less than 24 by 24 CSS pixels) are positioned so that if a 24 CSS pixel diameter circle is centered on the bounding box of each, the circles do not intersect another target or the circle for another undersized target;
  - Equivalent: The function can be achieved through a different control on the same page that meets this criterion;
  - Inline: The target is in a sentence or its size is otherwise constrained by the line-height of non-target text;
  - User agent control: The size of the target is determined by the user agent and is not modified by the author;
  - Essential: A particular presentation of the target is essential or is legally required for the information being conveyed.
- [WCAG 3.3.1 Error Identification](https://www.w3.org/WAI/WCAG22/Understanding/error-identification.html): If an input error is automatically detected, the item that is in error is identified and the error is described to the user in text.
- [WCAG 3.3.2 Labels or Instructions](https://www.w3.org/WAI/WCAG22/Understanding/labels-or-instructions.html): Labels or instructions are provided when content requires user input.
- [WCAG 3.3.3 Error Suggestion](https://www.w3.org/WAI/WCAG22/Understanding/error-suggestion.html): If an input error is automatically detected and suggestions for correction are known, then the suggestions are provided to the user, unless it would jeopardize the security or purpose of the content.
- [WCAG 4.1.2 Name, Role, Value](https://www.w3.org/WAI/WCAG22/Understanding/name-role-value): For all user interface components (including but not limited to: form elements, links and components generated by scripts), the name and role can be programmatically determined; states, properties, and values that can be set by the user can be programmatically set; and notification of changes to these items is available to user agents, including assistive technologies.

### What we provide

- To satisfy [WCAG 1.3.1 Info and Relationships](https://www.w3.org/WAI/WCAG22/Understanding/info-and-relationships.html) and [WCAG 4.1.2 Name, Role, Value](https://www.w3.org/WAI/WCAG22/Understanding/name-role-value), any `label`, `helper-text`, and `error-text` are associated with the input control by default.
- To satisfy [WCAG 1.4.4 Resize Text](https://www.w3.org/WAI/WCAG22/Understanding/resize-text.html), Input can be resized without assistive technology up to 200 percent without loss of content or functionality.
- To satisfy [WCAG 1.4.11 Non-text Contrast](https://www.w3.org/WAI/WCAG22/Understanding/non-text-contrast.html) and [WCAG 2.4.7 Focus Visible](https://www.w3.org/WAI/WCAG22/Understanding/focus-visible.html), interactive elements include focus styles.
- To satisfy [WCAG 2.1.1 Keyboard](https://www.w3.org/WAI/WCAG22/Understanding/keyboard.html), input replicates native input keyboard support. 
- To satisfy [WCAG 2.5.8 Target Size (Minimum)](https://www.w3.org/WAI/WCAG22/Understanding/target-size-minimum.html), the target size for the input field is at least 24 by 24 pixels so users can easily activate the control.

### Author Guidance

- To satisfy [WCAG 1.3.5 Identify Input Purpose](https://www.w3.org/WAI/WCAG22/Understanding/identify-input-purpose.html), use the `autocomplete` property to allow automated assistance in providing an input value.
- To satisy [WCAG 1.4.1 Use of Color](https://www.w3.org/WAI/WCAG22/Understanding/use-of-color.html), when using the `required` property and `show-indicator` attribute, include instructions at the top of the form to explain required inputs are marked with a red asterisk.
- To satisfy [WCAG 2.4.6 Headings and Labels](https://www.w3.org/WAI/WCAG22/Understanding/headings-and-labels.html) and [WCAG 3.3.2 Labels or Instructions](https://www.w3.org/WAI/WCAG22/Understanding/labels-or-instructions.html), ensure the `label` property or the `accessible-label` attribute are descriptive.
- To satisfy [WCAG 3.3.1 Error Identification](https://www.w3.org/WAI/WCAG22/Understanding/error-identification.html), set the `invalid` attribute to generate an `aria-invalid` attribute on input to indicate an error. Utilize the `error-text` attribute to provide feedback on a failed value.
- To satisfy [WCAG 3.3.3 Error Suggestion](https://www.w3.org/WAI/WCAG22/Understanding/error-suggestion.html), use the `error-text` attribute to provide a suggestion to correct the input error when appropriate.
- To satisfy [WCAG 4.1.2 Name, Role, Value](https://www.w3.org/WAI/WCAG22/Understanding/name-role-value), set the `accessible-label` attribute to generate an `aria-label` when a visible label cannot be used.

## Component API

For boolean attributes, true indicates that the attribute has been set without a value: `<jh-input show-indicator></jh-input>`. While false indicates the attribute does not exist in the DOM: `<jh-input></jh-input>`.

<ArgTypes />

## Feedback

Have an idea that will improve this component or have an issue to report? Let us know by submitting 
an issue on [GitHub](https://github.com/Banno/jack-henry-design-system/issues).

Engage with the community on our [GitHub discussion board](https://github.com/Banno/jack-henry-design-system/discussions).